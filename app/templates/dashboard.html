{% extends "base.html" %}
{% block content %}

<div style="margin-bottom: 3rem; text-align: center;">
    <h1 class="font-logo" style="font-size: 2.5rem; color: var(--cor-azul);">
        Dashboard Principal
    </h1>
    <p style="color: var(--cor-cinza-escuro); font-size: 1.125rem; margin-top: 0;">
        Ol√°, <strong style="color: var(--cor-azul);">{{ current_user.username }}</strong>! Gerencie seus dados de forma inteligente üöÄ
    </p>
</div>

<div class="stats-grid">
    <div class="stat-card">
        <div class="stat-label">Total de Formul√°rios</div>
        <div class="stat-value">{{ total_formularios }}</div>
    </div>
    <div class="stat-card" style="border-left-color: var(--cor-vermelho);">
        <div class="stat-label">Total de Respostas</div>
        <div class="stat-value" style="color: var(--cor-vermelho);">{{ total_estudantes }}</div>
    </div>
</div>

<div class="menu-actions">
    <h3 class="font-subtitle">A√ß√µes R√°pidas</h3>
    <a href="{{ url_for('main.manage_sheets') }}" role="button">Gerenciar Fontes de Dados</a>
    <a href="{{ url_for('main.view_processed_data') }}" role="button">Visualizar Dados</a>
    <a href="{{ url_for('main.analysis') }}" role="button">An√°lise Descritiva</a>
    <a href="{{ url_for('main.ml_analysis') }}" role="button">An√°lise com ML e IA</a>
</div>


{% if ultimos_formularios %}
<div style="margin-top: 3rem;">
    <h3 class="font-subtitle">√öltimos Formul√°rios Conectados</h3>
    <div style="overflow-x: auto;">
        <table>
            <thead>
                <tr>
                    <th>Nome do Formul√°rio</th>
                    <th>Data de Cadastro</th>
                    <th style="text-align: center;">A√ß√µes</th>
                </tr>
            </thead>
            <tbody>
                {% for formulario in ultimos_formularios %}
                <tr>
                    <td><strong>{{ formulario.nome_amigavel }}</strong></td>
                    <td>{{ formulario.data_cadastro.strftime('%d/%m/%Y') }}</td>
                    <td style="text-align: center;">
                        <a href="{{ url_for('main.process_sheet', planilha_id=formulario.id) }}" role="button" class="outline" style="margin: 0;">Processar</a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endif %}

<footer style="margin-top: 3rem; text-align: center;">
    {% if not current_user.google_credentials %}
        <p>‚ö†Ô∏è Para interagir com o Google, voc√™ precisa conectar sua conta.</p>
        <a href="{{ url_for('main.authorize_google') }}" role="button">Conectar com o Google</a>
    {% else %}
        <p>‚úÖ Conectado como: <strong>{{ current_user.email }}</strong></p>
        <a href="{{ url_for('main.disconnect_google') }}" role="button" class="outline" style="border-color: var(--cor-vermelho); color: var(--cor-vermelho)!important;">Desconectar</a>
    {% endif %}
</footer>

{% endblock %}