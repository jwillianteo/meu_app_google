{% extends "base.html" %}
{% block content %}
    <a href="{{ url_for('main.search_sheets') }}" role="button">
        <span style="font-size: 1.2rem; margin-right: 0.5rem;">üîç</span>
        Buscar Formul√°rios no meu Google Drive
    </a>

    <h3 style="margin-top: 2em;">Formul√°rios Conectados</h3>
    {% if planilhas %}
        <figure>
            <table>
                <thead>
                    <tr>
                        <th scope="col">Nome do Formul√°rio</th>
                        <th scope="col">ID da Planilha</th>
                        <th scope="col" style="text-align: center;">A√ß√µes</th>
                    </tr>
                </thead>
                <tbody>
                    {% for p in planilhas %}
                    <tr>
                        <td><strong>{{ p.nome_amigavel }}</strong></td>
                        <td><small>{{ p.spreadsheet_id }}</small></td>
                        <td style="text-align: center;">
                            <div style="display: flex; gap: 0.5rem; justify-content: center; flex-wrap: wrap;">
                                
                                <a href="{{ url_for('main.process_sheet', planilha_id=p.id) }}" role="button" class="outline" style="margin: 0;">
                                    ‚öôÔ∏è Processar
                                </a>
                                
                                <form method="POST" action="{{ url_for('main.remove_sheet', planilha_id=p.id) }}" 
                                      onsubmit="return confirm('Tem certeza que deseja desconectar este formul√°rio? Os dados j√° processados ser√£o removidos do sistema, mas a planilha original no seu Google Drive N√ÉO ser√° alterada.');" 
                                      style="margin: 0;">
                                    <button type="submit" class="outline" style="margin: 0; border-color: var(--cor-vermelho); color: var(--cor-vermelho) !important;">
                                        üîå Desconectar
                                    </button>
                                </form>

                            </div>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </figure>
    {% else %}
        <article style="text-align: center; padding: 2rem; border: 2px dashed #ccc;">
            <p style="font-size: 1.1rem; color: #555;">Voc√™ ainda n√£o conectou nenhum formul√°rio.</p>
            <p>Clique no bot√£o acima para buscar e adicionar seu primeiro formul√°rio.</p>
        </article>
    {% endif %}
    
    <div style="text-align: center; margin-top: 2rem;">
        <a href="{{ url_for('main.dashboard') }}" role="button">‚Üê Voltar ao Dashboard</a>
    </div>
{% endblock %}